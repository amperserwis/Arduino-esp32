#########################
Migration from 2.x to 3.0
#########################

Introduction
------------

This is a guide to highlight breaking changes in the API and to help the migration of projects from versions 2.X to version 3.0 of the Arduino ESP32 core. 
For more information about the changes and new features, check `RELEASE NOTES <https://github.com/espressif/arduino-esp32/releases>`_.

ADC
---

Removed APIs
************

* ``analogSetClockDiv``
* ``adcAttachPin``
* ``analogSetVRefPin``

BLE
---

Changes in APIs
***************

* Changed APIs return and parameter type from ``std::string`` to Arduino style ``String``.
* Changed UUID data type from ``uint16_t`` to ``BLEUUID`` class.

Hall Sensor
-----------

Hall sensor is no longer supported.

Removed APIs
************

* ``hallRead``

I2S
---

The I2S driver has been completely redesigned and refactored to use the new ESP-IDF driver. 
For more information about the new API, check `I2S API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/i2s.html>`_.

LEDC
----

The LEDC API has been changed in order to support the Peripheral Manager and make it easier to use, as LEDC channels are now automatically assigned to pins.
For more information about the new API, check `LEDC API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/ledc.html>`_.

Removed APIs
************

* ``ledcSetup``
* ``ledcAttachPin``

New APIs
********

* ``ledcAttach`` used to set up the LEDC pin (merged ``ledcSetup`` and ``ledcAttachPin`` functions).
* ``timerGetFrequency`` used to get the actual frequency of the timer.
* ``timerAttachInterruptArg`` used to attach the interrupt to a timer using arguments.

Changes in APIs
***************

* ``ledcDetachPin`` renamed to ``ledcDetach``.
* In all functions, input parameter ``channel`` has been changed to ``pin``.

RMT
---

TODO:
For more information about the new API, check `RMT API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/rmt.html>`_.

Removed APIs
************

TODO:

New APIs
********

TODO:

Changes in APIs
***************

TODO:

SigmaDelta
----------

SigmaDelta has been refactored to use the new ESP-IDF driver.
For more information about the new API, check `SigmaDelta API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/sigmadelta.html>`_.

Removed APIs
************

* ``sigmaDeltaSetup``
* ``sigmaDeltaRead``

New APIs
********

* ``sigmaDeltaAttach`` used to set up the SigmaDelta pin (channel is acquired automatically).
* ``timerGetFrequency`` used to get the actual frequency of the timer.
* ``timerAttachInterruptArg`` used to attach the interrupt to a timer using arguments.

Changes in APIs
***************

* ``sigmaDeltaDetachPin`` renamed to ``sigmaDeltaDetach``.
* ``sigmaDeltaWrite`` input parameter ``channel`` has been changed to ``pin``.

Timer
-----

Timer has been refactored to use the new ESP-IDF driver and its API got simplified. For more information about the new API check
`TIMER API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/timer.html>`_.

Removed APIs
************

* ``timerGetConfig``
* ``timerSetConfig``
* ``timerSetDivider``
* ``timerSetCountUp``
* ``timerSetAutoReload``
* ``timerGetDivider``
* ``timerGetCountUp``
* ``timerGetAutoReload``
* ``timerAlarmEnable``
* ``timerAlarmDisable``
* ``timerAlarmWrite``
* ``timerAlarmEnabled``
* ``timerAlarmRead``
* ``timerAlarmReadMicros``
* ``timerAlarmReadSeconds``
* ``timerAttachInterruptFlag``

New APIs
********

* ``timerAlarm`` used to set up Alarm for the timer and enable it automatically (merged ``timerAlarmWrite`` and ``timerAlarmEnable`` functions).
* ``timerGetFrequency`` used to get the actual frequency of the timer.
* ``timerAttachInterruptArg`` used to attach the interrupt to a timer using arguments.

Changes in APIs
***************

* ``timerBegin`` has now only 1 parameter (frequency). There is an automatic calculation of the divider using different clock sources
  to achieve the selected frequency.
* ``timerAttachInterrupt`` has now only 2 parameters. The ``edge`` parameter has been removed.

UART
----

TODO:
For more information about the new API, check `UART API <https://docs.espressif.com/projects/arduino-esp32/en/latest/api/rmt.html>`_.

Removed APIs
************

TODO:

New APIs
********

TODO:

Changes in APIs
***************

TODO: